This is converted to Lazarus version of VCL/CLX program
HelpGenerator by Richard B. Winston.
I (Michalis) converted it to Lazarus (LCL). This is a portable code,
it should compile and work everywhere where FPC, FCL, LCL are ported.

It depends on pasdoc_package for Lazarus in pasdoc sources,
so be sure to install pasdoc_package in Lazarus before opening
pasdoc_gui project.

I'm also putting this source code under GNU GPL (original version
was on public domain). This should effectively solve any legal concerns
with HelpGenerator that I mentioned on pasdoc-main list:
now we have
- GNU GPLed program that uses
- GNU GPLed pasdoc and
- LCL (released on modified GNU LGPL).
So everything if free, legal, binaries of this program may be
distributed without problems etc.

Of course solving the legal concerns was not the main goal,
the main goals are:

- demonstrate using pasdoc components in Lazarus

- provide alternative way to use pasdoc for people that
  don't want to learn pasdoc's command-line and don't need
  to call pasdoc in "batch" mode.

  This was also intention of original HelpGenerator, but now
  we got it absolutely free, without any dependency on Delphi/Kylix,
  and portable everywhere where FPC is.

  TODO: Although it should be easy to modify this program
  to let it be called in batch mode. This would allow users
  to create their configuration using GUI, then call this program
  (or some other) giving name of the file with settings as
  parameter. This would allow users to still use pasdoc functionality
  in batch mode, and at the same time not learn pasdoc's command-line.

I did many other changes while converting:
- I renamed it to "pasdoc_gui" (instead of "HelpGenerator"),
  because I just consider it a better name.

  I also changed output extension to "pds" (was "hgs").
  This not only reflects new name, but it also reflects the fact
  that pasdoc_gui *cannot* read files written by HelpGenerator.
  See lower in this file for description why I changed the way
  settings are read/written.

- I removed dependency on MemCheck unit, not only because it's does not
  comply with GNU GPL free but also because it's absolutely useless for
  FPC programs. (HeapTrc unit exists for FPC that does roughly what
  MemCheck unit does for Delphi).

- I also removed USGS copyright notices at the beginning of the file
  frmhelpgeneratorunit.pas because they were making unclear
  statements about what and how is required.
  I replaced them with standard GNU GPL copyright preamble.

  My basis is that original code by Richard is said to be
  on public domain, so I can do anything with it, including licensing
  modified version of HelpGenerator as GNU GPL sources.

  If someone thinks that I cannot do this, I will obey.
  Although I prefer to develop free software using GNU GPL,
  and a "clean GNU GPL", without any additional legal statements.

  Richard: even if what I did is OK, you may still want me to change
  the first line of copyright. I put there
  "Copyright 2004-2005 Richard B. Winston, U.S. Geological Survey (USGS)"
  basing on previous copyright comments.

- Part of "Options" tab splitted to "Header/Footer" tab to make it
  smaller.

- "About" form changed.

- Running external browser is implemented using TProcess.

- Let me elaborate a little why previous system with saving
  setting was not working correctly:

  When you save a component to a stream, Delphi and FPC do not write
  properties that have a default value. This is against the spirit
  of what was assumed in HelpGenerator code, that incorrectly *assumed*
  that this will always be done.

  You can see this bug in HelpGenerator:
  1. clear "Defines" memo
  2. save project as "foo.hgs"
  3. write some values in "Defines" memo, like 'FPC'
  4. load project as "foo.hgs"
  Bug: "Defines" memo contains value 'FPC', but it shouldn't, because
  "foo.hgs" says that no defines should be specified.
  Why ? Because ObjectPascal streaming system did not record in "foo.hgs"
  file value of Directives property, it assumed that having Count=0 is the
  default state of "Defines" property, so there is no need to save it.

  There are a couple of property types where this behavior will always be
  present, e.g. string properties are never saved when their value is '' etc.
  For *some* properties (namely, ones that are obtained via GetOrdProp RTTI call,
  with the exception of "Integer default $80000000" because $80000000 is special)
  you can reliably tell Delphi to always save them (regardless of their
  value) but
  1. this is uncleanly done in Delphi (because it's not a general solution,
     it doesn't work for all property types (it doesn't work for TString
     property or a string property), and there's that funny thing
     with $80000000 being special)
  2. unfortunately FPC does not implement it for now. This means that
     in FPC property always has some implicit default value, like "false"
     for booleans and "0" for integers. There is *no* way to tell FPC
     to always save a boolean property to a file (regardless of value
     of that property). See this thread in fpc-pascal mailing archives:
     [http://www.nl.freepascal.org/lists/fpc-pascal/2005-April/008267.html]

  What does it mean in a "general view" ?
  Using ObjectPascal streaming system is a perfect (and easy) way
  when you always load object from a file *right after* creating it
  and you're prepared that if some property has some default value,
  it's "Set" method will not be called by the streaming system at all.
  Streaming system simply assumes that properties are already correctly
  set to their default values.

  That's why I decided that it will be simplest to simply resign from
  using separate THelpGeneratorProjectOptions class at all.
  I simply remade reading/writing everything using simple TIniFile.
  This means that adding new things to a settings file is a little
  more error-prone (you don't have to add only one property to some
  class, you have to remember to add both the reading and the writing
  code to appropriate places). Although in fact it's simpler and shorter
  (less dummy Get/Set methods, also no need for dummy splitting
  of clbMethodVisibility items to 5 boolean properties.)

  As for now, I see that my version of frmHelpGenerator has 250 lines
  less than original one :) OK, I surprised myself :)

- Implementation of SetDefaults extended with things that were originally
  only in New1Click. This is for clarity.

- Oh, and I changed default "Defines" from Delphi and Win32 oriented
  to FPC and Linux oriented. Sorry, I just couldn't resists :)

  Seriously, this is TODO: pasdoc_gui should allow user to configure
  default state of these Defines. Actually, it should allow user
  to configure default state of *all* options.
  E.g. maybe someone always wants to make default language of docs = Polish ?
  Maybe someone wants default verbosity = 6 ?
  Maybe someone has some include directory with his include files that
  he wants to always be added to "Include dirs" by default ?
  This can all be very nicely solved by storing some "default project settings"
  in user's directory and loading it on program start (and menu "New" execution).
  Then the code that currently loads contents from Ini file can be modified
  to actually have really good default values, and instead of using "SetDefaults"
  we simply load from a file where "default project settings" for this user
  are stored (like ~/.pasdoc_gui/default.pds on Unixes)

Some other TODOs:
- spinedit has wrong width at runtime on Win32.
  This is most probably a problem in Win32 Lazarus code.
  GTK 1 version has no problems.

- Default value of EditHtmlBrowserCommand.Text
  should be read from some user's config file.

  Also this should allow using environment variable,
  e.g. $BROWSER would be better default value under UNIXes
  than current `sensible-browser' (sensible-browser is Debianism).

  Also this should allow executing "default shell association"
  for HTML under Win32, using ShellExecute.
  Under UNIXes the equivalent is already available, just use `run-mailcap'.

- Caption should reflect current filename of the project, or 'noname.pds'
  if it's not saved yet. Also '*' should be added when Changed = true.

  These are the common ways to say user what filename he is editing
  (because he *is* editing a file using pasdoc_gui: he's editing
  his PasDoc Settings, pds file) and what is the value of Changed.

  This would also render unnecessary the code
  "PageControl1.ActivePageIndex := 0;"
  currently done when user executes "New" menu command.
  I find it unpleasant, but for now it's sometimes necessary to clearly
  show the user that settings were reseted.

- Layout of controls is not controlled as good as it should be.
  You may encounter problems if you use unusually large fonts etc.
  This is partially because of lame (nonexistent?) Delphi positioning
  scheme, partially because of problems with keeping such things
  portable in Lazarus (across GTK and Win32 component sets).

  It's a shame for me, but for now each time I switched between
  GTK and Win32 I found that I have to readjust layout of some things
  a little... Hopefully these issues are now gone and layout looks good
  for everyone, but I'm not happy with it, really.